任务切换 ， 即应用在运行中主动或被动地交出 CPU 的使用权，内核可以选择另一个程序继续执行。 内核需要保证用户程序两次运行期间，任务上下文（如寄存器、栈等）保持一致。
1. 与 Trap 切换不同，它不涉及特权级切换，部分由编译器完成；
2. 与 Trap 切换相同，它对应用是透明的。

任务切换是来自两个不同应用在内核中的 Trap 控制流之间的切换。
当一个应用 Trap 到 S 态 OS 内核中进行进一步处理时， 其 Trap 控制流可以调用一个特殊的 __switch 函数。
在 __switch 返回之后，Trap 控制流将继续从调用该函数的位置继续向下执行。
 而在调用 __switch 之后到返回前的这段时间里， 原 Trap 控制流 A 会
 先被暂停并被**切换**出去， CPU 转而运行另一个应用的 Trap 控制流 B
 __switch 返回之后，原 Trap 控制流 A 才会从某一条 Trap 控制流 C **切换**回来继续执行。

 我们需要在 __switch 中保存 CPU 的某些寄存器，它们就是 **任务上下文**